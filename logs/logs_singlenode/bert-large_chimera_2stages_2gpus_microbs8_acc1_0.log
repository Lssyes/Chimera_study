[Running nsys_wrap.sh rank: 0]
output----bert_prof/bert-large_chimera_2stages_2gpus_microbs8_acc1_node_rank0
Warning: LBR backtrace method is not supported on this platform. DWARF backtrace method will be used.
Capture range started in the application
Collecting data...
当前时间: 2024-06-07 19:57:44
tcp://192.168.0.5:1234
0
local_rank 0, local_size 1, rank-0, world_size-2
[[stage_to_ranks]] -> {0: [0, 1], 1: [1, 0]}
[[[[[[[[[[999999]]]]]]]]]]
[[[[[[[[[[999999]]]]]]]]]]
[total_num_samples_per_step: 16]]]]]]]]]]
[max_steps_per_epoch:        62499]]]]]]]]]]
total_num_samples: 128 num_epochs: 1
============================
pipeline_method: chimera
num_epochs: 1
num_optimization_steps: 8
world_size: 2
num_replica: 2
num_pipeline: 2
num_micro_batches_per_step: 1
recompute: False
stage0: ranks [0, 1]
stage1: ranks [1, 0]
----------------------------
corpus_path: ./bert_data/wikipedia.segmented.nltk.txt.1
corpus_lines: 1000000
vocab_path: ./bert_data/bert-large-uncased-vocab.txt
on_memory: False
do_lower_case: True
bert_config_path: ./configs/bert_config_bert-large-uncased.json
max_seq_length: 128
micro_batch_size: 8
num_optimization_steps: 8
num_epochs: None
gradient_accumulation_steps: 1
adam_learning_rate: 3e-05
adam_max_grad_norm: 1.0
beta1: 0.9
weight_decay: 0.01
warmup_proportion: 0.1
damping: 0.01
pipeline_method: chimera
chunks: 2
recompute: False
num_stages: 2
num_pipelines: 2
checkpoint_dir: None
save_checkpoint_steps: 200
seed: 1
p2p_backend: gloo
collective_backend: nccl
num_workers: 4
profile: True
observe_norm: False
log_interval: 1
config: None
wandb: False
============================
[[pytorch sync]] 0 epoch
[[Chimera start]] 0 epoch
[<pipeline.PipelineStage object at 0x7efdbc18e3a0>, <pipeline.PipelineStage object at 0x7efdbc18e6d0>]
shiiitttt epoch-0 step-0 num_steps_for_this_epoch-8 num_p2p_comm-8
Capture range ended in the application
Processing events...
Saving temporary "/tmp/nsys-report-31d3-9842-dcfe-8091.qdstrm" file to disk...

Creating final output files...
Processing [0%                                                                 ]Processing [=====12%                                                           ]Processing [=============24%                                                   ]Processing [=====================================61%                           ]Processing [==============================================================98%  ]Processing [===============================================================99% ]Processing [===================================57%                             ]Processing [=======================40%                                         ]Processing [=================31%                                               ]Processing [=============24%                                                   ]Processing [==========20%                                                      ]Processing [========17%                                                        ]Processing [=======15%                                                         ]Processing [=====13%                                                           ]Processing [=====12%                                                           ]Processing [====11%                                                            ]Processing [===10%                                                             ]Processing [====9%                                                             ]Processing [===8%                                                              ]Processing [==7%                                                               ]Processing [==6%                                                               ]Processing [=5%                                                                ]Processing [4%                                                                 ]Processing [3%                                                                 ]Processing [2%                                                                 ]Processing [1%                                                                 ]Processing [2%                                                                 ]Processing [4%                                                                 ]Processing [=5%                                                                ]Processing [==6%                                                               ]Processing [==7%                                                               ]Processing [===8%                                                              ]Processing [====9%                                                             ]Processing [===10%                                                             ]Processing [====11%                                                            ]Processing [=====12%                                                           ]Processing [=====13%                                                           ]Processing [======14%                                                          ]Processing [=======15%                                                         ]Processing [=======16%                                                         ]Processing [=========18%                                                       ]Processing [=========19%                                                       ]Processing [==========20%                                                      ]Processing [===========21%                                                     ]Processing [===========22%                                                     ]Processing [============23%                                                    ]Processing [=============24%                                                   ]Processing [=============25%                                                   ]Processing [==============26%                                                  ]Processing [===============27%                                                 ]Processing [===============28%                                                 ]Processing [================29%                                                ]Processing [=================30%                                               ]Processing [=================31%                                               ]Processing [==================32%                                              ]Processing [===================33%                                             ]Processing [===================34%                                             ]Processing [====================35%                                            ]Processing [=====================36%                                           ]Processing [======================38%                                          ]Processing [=======================39%                                         ]Processing [=======================40%                                         ]Processing [========================41%                                        ]Processing [=========================42%                                       ]Processing [=========================43%                                       ]Processing [==========================44%                                      ]Processing [===========================45%                                     ]Processing [===========================46%                                     ]Processing [============================47%                                    ]Processing [=============================48%                                   ]Processing [=============================49%                                   ]Processing [==============================50%                                  ]Processing [===============================51%                                 ]Processing [===============================52%                                 ]Processing [================================53%                                ]Processing [=================================54%                               ]Processing [=================================55%                               ]Processing [==================================56%                              ]Processing [===================================57%                             ]Processing [===================================58%                             ]Processing [=====================================60%                           ]Processing [=====================================61%                           ]Processing [======================================62%                          ]Processing [=======================================63%                         ]Processing [=======================================64%                         ]Processing [========================================65%                        ]Processing [=========================================66%                       ]Processing [=========================================67%                       ]Processing [==========================================68%                      ]Processing [===========================================69%                     ]Processing [===========================================70%                     ]Processing [============================================71%                    ]Processing [=============================================72%                   ]Processing [=============================================73%                   ]Processing [==============================================74%                  ]Processing [===============================================75%                 ]Processing [===============================================76%                 ]Processing [===============================================================100%]
Saved report file to "/tmp/nsys-report-31d3-9842-dcfe-8091.qdrep"
Exporting 171020 events: [1%                                                   ]Exporting 171020 events: [2%                                                   ]Exporting 171020 events: [3%                                                   ]Exporting 171020 events: [4%                                                   ]Exporting 171020 events: [5%                                                   ]Exporting 171020 events: [=6%                                                  ]Exporting 171020 events: [=7%                                                  ]Exporting 171020 events: [==8%                                                 ]Exporting 171020 events: [==9%                                                 ]Exporting 171020 events: [==10%                                                ]Exporting 171020 events: [==11%                                                ]Exporting 171020 events: [===12%                                               ]Exporting 171020 events: [===13%                                               ]Exporting 171020 events: [====14%                                              ]Exporting 171020 events: [====15%                                              ]Exporting 171020 events: [=====16%                                             ]Exporting 171020 events: [======17%                                            ]Exporting 171020 events: [======18%                                            ]Exporting 171020 events: [=======19%                                           ]Exporting 171020 events: [=======20%                                           ]Exporting 171020 events: [========21%                                          ]Exporting 171020 events: [========22%                                          ]Exporting 171020 events: [=========23%                                         ]Exporting 171020 events: [=========24%                                         ]Exporting 171020 events: [==========25%                                        ]Exporting 171020 events: [==========26%                                        ]Exporting 171020 events: [===========27%                                       ]Exporting 171020 events: [===========28%                                       ]Exporting 171020 events: [============29%                                      ]Exporting 171020 events: [============30%                                      ]Exporting 171020 events: [=============31%                                     ]Exporting 171020 events: [=============32%                                     ]Exporting 171020 events: [==============33%                                    ]Exporting 171020 events: [===============34%                                   ]Exporting 171020 events: [===============35%                                   ]Exporting 171020 events: [================36%                                  ]Exporting 171020 events: [================37%                                  ]Exporting 171020 events: [=================38%                                 ]Exporting 171020 events: [=================39%                                 ]Exporting 171020 events: [==================40%                                ]Exporting 171020 events: [==================41%                                ]Exporting 171020 events: [===================42%                               ]Exporting 171020 events: [===================43%                               ]Exporting 171020 events: [====================44%                              ]Exporting 171020 events: [====================45%                              ]Exporting 171020 events: [=====================46%                             ]Exporting 171020 events: [=====================47%                             ]Exporting 171020 events: [======================48%                            ]Exporting 171020 events: [======================49%                            ]Exporting 171020 events: [=======================50%                           ]Exporting 171020 events: [========================51%                          ]Exporting 171020 events: [========================52%                          ]Exporting 171020 events: [=========================53%                         ]Exporting 171020 events: [=========================54%                         ]Exporting 171020 events: [==========================55%                        ]Exporting 171020 events: [==========================56%                        ]Exporting 171020 events: [===========================57%                       ]Exporting 171020 events: [===========================58%                       ]Exporting 171020 events: [============================59%                      ]Exporting 171020 events: [============================60%                      ]Exporting 171020 events: [=============================61%                     ]Exporting 171020 events: [=============================62%                     ]Exporting 171020 events: [==============================63%                    ]Exporting 171020 events: [==============================64%                    ]Exporting 171020 events: [===============================65%                   ]Exporting 171020 events: [===============================66%                   ]Exporting 171020 events: [================================67%                  ]Exporting 171020 events: [=================================68%                 ]Exporting 171020 events: [=================================69%                 ]Exporting 171020 events: [==================================70%                ]Exporting 171020 events: [==================================71%                ]Exporting 171020 events: [===================================72%               ]Exporting 171020 events: [===================================73%               ]Exporting 171020 events: [====================================74%              ]Exporting 171020 events: [====================================75%              ]Exporting 171020 events: [=====================================76%             ]Exporting 171020 events: [=====================================77%             ]Exporting 171020 events: [======================================78%            ]Exporting 171020 events: [======================================79%            ]Exporting 171020 events: [=======================================80%           ]Exporting 171020 events: [=======================================81%           ]Exporting 171020 events: [========================================82%          ]Exporting 171020 events: [========================================83%          ]Exporting 171020 events: [=========================================84%         ]Exporting 171020 events: [==========================================85%        ]Exporting 171020 events: [==========================================86%        ]Exporting 171020 events: [===========================================87%       ]Exporting 171020 events: [===========================================88%       ]Exporting 171020 events: [============================================89%      ]Exporting 171020 events: [============================================90%      ]Exporting 171020 events: [=============================================91%     ]Exporting 171020 events: [=============================================92%     ]Exporting 171020 events: [==============================================93%    ]Exporting 171020 events: [==============================================94%    ]Exporting 171020 events: [===============================================95%   ]Exporting 171020 events: [===============================================96%   ]Exporting 171020 events: [================================================97%  ]Exporting 171020 events: [================================================98%  ]Exporting 171020 events: [=================================================99% ]Exporting 171020 events: [=================================================100%]

Exported successfully to
/tmp/nsys-report-31d3-9842-dcfe-8091.sqlite
Report file moved to "/workspace/Chimera/bert_prof/bert-large_chimera_2stages_2gpus_microbs8_acc1_rank0.qdrep"
Report file moved to "/workspace/Chimera/bert_prof/bert-large_chimera_2stages_2gpus_microbs8_acc1_rank0.sqlite"


Sent signal 15 (Terminated) to target application's process group ID = 27194.
Use the kill option to modify this behavior.

The target application terminated with signal 15 (SIGTERM)
Training script completed at Fri Jun  7 19:58:01 +03 2024
nsys script completed at Fri Jun  7 19:58:31 +03 2024
