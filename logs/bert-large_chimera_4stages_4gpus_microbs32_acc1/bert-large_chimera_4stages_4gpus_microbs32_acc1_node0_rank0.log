[Running nsys_wrap.sh rank: 0]
output----bert_prof/bert-large_chimera_4stages_4gpus_microbs32_acc1_node_rank0
python: /usr/bin/python3.8 /usr/lib/python3.8 /usr/lib/python3.9 /usr/lib/python2.7 /etc/python3.8 /usr/local/lib/python3.8 /opt/conda/bin/python3.8 /opt/conda/bin/python /opt/conda/bin/python3.8-config
/workspace/Chimera
Warning: LBR backtrace method is not supported on this platform. DWARF backtrace method will be used.
Capture range started in the application
Collecting data...
当前时间: 2024-06-09 22:21:31
tcp://192.168.0.5:1234
0
local_rank 0, local_size 2, rank-0, world_size-4
[[stage_to_ranks]] -> {0: [0, 3], 1: [1, 2], 2: [2, 1], 3: [3, 0]}
[[[[[[[[[[9999]]]]]]]]]]
[[[[[[[[[[9999]]]]]]]]]]
[total_num_samples_per_step: 128]]]]]]]]]]
[max_steps_per_epoch:        78]]]]]]]]]]
total_num_samples: 1024 num_epochs: 1
============================
pipeline_method: chimera
num_epochs: 1
num_optimization_steps: 8
world_size: 4
num_replica: 2
num_pipeline: 2
num_micro_batches_per_step: 2
recompute: False
stage0: ranks [0, 3]
stage1: ranks [1, 2]
stage2: ranks [2, 1]
stage3: ranks [3, 0]
----------------------------
corpus_path: ./bert_data/wikipedia.segmented.nltk.txt
corpus_lines: 10000
vocab_path: ./bert_data/bert-large-uncased-vocab.txt
on_memory: False
do_lower_case: True
bert_config_path: ./configs/bert_config_bert-large-uncased.json
max_seq_length: 128
micro_batch_size: 32
num_optimization_steps: 8
num_epochs: None
gradient_accumulation_steps: 1
adam_learning_rate: 3e-05
adam_max_grad_norm: 1.0
beta1: 0.9
weight_decay: 0.01
warmup_proportion: 0.1
damping: 0.01
pipeline_method: chimera
chunks: 2
recompute: False
num_stages: 4
num_pipelines: 2
checkpoint_dir: None
save_checkpoint_steps: 200
seed: 1
p2p_backend: gloo
collective_backend: nccl
num_workers: 4
profile: True
observe_norm: False
log_interval: 1
config: None
wandb: False
============================
[[pytorch sync]] 0 epoch
[[Chimera start]] 0 epoch
[<pipeline.PipelineStage object at 0x7f3466da18e0>, <pipeline.PipelineStage object at 0x7f3466da1be0>]
shiiitttt epoch-0 step-0 num_steps_for_this_epoch-8 num_p2p_comm-16
Capture range ended in the application
Processing events...
Saving temporary "/tmp/nsys-report-9800-231a-1f8f-44a5.qdstrm" file to disk...

Creating final output files...
Processing [0%                                                                 ]Processing [==7%                                                               ]Processing [=======15%                                                         ]Processing [===============================51%                                 ]Processing [=======================================================88%         ]Processing [========================================================89%        ]Processing [=========================================================90%       ]Processing [=========================================================91%       ]Processing [==========================================================92%      ]Processing [===========================================================93%     ]Processing [===========================================================94%     ]Processing [============================================================95%    ]Processing [=============================================================96%   ]Processing [=============================================================97%   ]Processing [==============================================================98%  ]Processing [===============================================================99% ]Processing [===================================57%                             ]Processing [========================41%                                        ]Processing [==================32%                                              ]Processing [==============26%                                                  ]Processing [===========22%                                                     ]Processing [=========19%                                                       ]Processing [=======16%                                                         ]Processing [=======15%                                                         ]Processing [=====13%                                                           ]Processing [=====12%                                                           ]Processing [====11%                                                            ]Processing [===10%                                                             ]Processing [====9%                                                             ]Processing [===8%                                                              ]Processing [==7%                                                               ]Processing [==6%                                                               ]Processing [=5%                                                                ]Processing [4%                                                                 ]Processing [3%                                                                 ]Processing [2%                                                                 ]Processing [1%                                                                 ]Processing [0%                                                                 ]Processing [1%                                                                 ]Processing [2%                                                                 ]Processing [3%                                                                 ]Processing [4%                                                                 ]Processing [=5%                                                                ]Processing [==6%                                                               ]Processing [==7%                                                               ]Processing [===8%                                                              ]Processing [====9%                                                             ]Processing [===10%                                                             ]Processing [====11%                                                            ]Processing [=====12%                                                           ]Processing [=====13%                                                           ]Processing [======14%                                                          ]Processing [=======15%                                                         ]Processing [=======16%                                                         ]Processing [========17%                                                        ]Processing [=========18%                                                       ]Processing [=========19%                                                       ]Processing [==========20%                                                      ]Processing [===========21%                                                     ]Processing [===========22%                                                     ]Processing [============23%                                                    ]Processing [=============24%                                                   ]Processing [=============25%                                                   ]Processing [==============26%                                                  ]Processing [===============27%                                                 ]Processing [===============28%                                                 ]Processing [================29%                                                ]Processing [=================30%                                               ]Processing [=================31%                                               ]Processing [==================32%                                              ]Processing [===================33%                                             ]Processing [===================34%                                             ]Processing [====================35%                                            ]Processing [=====================36%                                           ]Processing [=====================37%                                           ]Processing [======================38%                                          ]Processing [=======================39%                                         ]Processing [=======================40%                                         ]Processing [========================41%                                        ]Processing [=========================42%                                       ]Processing [=========================43%                                       ]Processing [==========================44%                                      ]Processing [===========================45%                                     ]Processing [===========================46%                                     ]Processing [============================47%                                    ]Processing [=============================48%                                   ]Processing [=============================49%                                   ]Processing [==============================50%                                  ]Processing [===============================51%                                 ]Processing [===============================52%                                 ]Processing [================================53%                                ]Processing [=================================54%                               ]Processing [=================================55%                               ]Processing [==================================56%                              ]Processing [===================================57%                             ]Processing [===================================58%                             ]Processing [====================================59%                            ]Processing [=====================================60%                           ]Processing [=====================================61%                           ]Processing [======================================62%                          ]Processing [=======================================63%                         ]Processing [=======================================64%                         ]Processing [========================================65%                        ]Processing [=========================================66%                       ]Processing [=========================================67%                       ]Processing [==========================================68%                      ]Processing [===========================================69%                     ]Processing [===========================================70%                     ]Processing [============================================71%                    ]Processing [=============================================72%                   ]Processing [=============================================73%                   ]Processing [==============================================74%                  ]Processing [===============================================75%                 ]Processing [===============================================76%                 ]Processing [================================================77%                ]Processing [=================================================78%               ]Processing [=================================================79%               ]Processing [==================================================80%              ]Processing [===================================================81%             ]Processing [===================================================82%             ]Processing [====================================================83%            ]Processing [=====================================================84%           ]Processing [=====================================================85%           ]Processing [======================================================86%          ]Processing [=======================================================87%         ]Processing [=======================================================88%         ]Processing [========================================================89%        ]Processing [=========================================================90%       ]Processing [=========================================================91%       ]Processing [==========================================================92%      ]Processing [===========================================================93%     ]Processing [===========================================================94%     ]Processing [============================================================95%    ]Processing [=============================================================96%   ]Processing [=============================================================97%   ]Processing [==============================================================98%  ]Processing [===============================================================99% ]Processing [===============================================================100%]
Saved report file to "/tmp/nsys-report-9800-231a-1f8f-44a5.qdrep"
Exporting 46031941 events: [1%                                                 ]Exporting 46031941 events: [2%                                                 ]Exporting 46031941 events: [3%                                                 ]Exporting 46031941 events: [4%                                                 ]Exporting 46031941 events: [5%                                                 ]Exporting 46031941 events: [=6%                                                ]Exporting 46031941 events: [=7%                                                ]Exporting 46031941 events: [==8%                                               ]Exporting 46031941 events: [==9%                                               ]Exporting 46031941 events: [==10%                                              ]Exporting 46031941 events: [==11%                                              ]Exporting 46031941 events: [===12%                                             ]Exporting 46031941 events: [===13%                                             ]Exporting 46031941 events: [====14%                                            ]Exporting 46031941 events: [====15%                                            ]Exporting 46031941 events: [=====16%                                           ]Exporting 46031941 events: [=====17%                                           ]Exporting 46031941 events: [======18%                                          ]Exporting 46031941 events: [======19%                                          ]Exporting 46031941 events: [=======20%                                         ]Exporting 46031941 events: [=======21%                                         ]Exporting 46031941 events: [========22%                                        ]Exporting 46031941 events: [========23%                                        ]Exporting 46031941 events: [=========24%                                       ]Exporting 46031941 events: [=========25%                                       ]Exporting 46031941 events: [==========26%                                      ]Exporting 46031941 events: [==========27%                                      ]Exporting 46031941 events: [===========28%                                     ]Exporting 46031941 events: [===========29%                                     ]Exporting 46031941 events: [============30%                                    ]Exporting 46031941 events: [============31%                                    ]Exporting 46031941 events: [=============32%                                   ]Exporting 46031941 events: [=============33%                                   ]Exporting 46031941 events: [==============34%                                  ]Exporting 46031941 events: [==============35%                                  ]Exporting 46031941 events: [===============36%                                 ]Exporting 46031941 events: [===============37%                                 ]Exporting 46031941 events: [================38%                                ]Exporting 46031941 events: [================39%                                ]Exporting 46031941 events: [=================40%                               ]Exporting 46031941 events: [=================41%                               ]Exporting 46031941 events: [==================42%                              ]Exporting 46031941 events: [==================43%                              ]Exporting 46031941 events: [===================44%                             ]Exporting 46031941 events: [===================45%                             ]Exporting 46031941 events: [====================46%                            ]Exporting 46031941 events: [====================47%                            ]Exporting 46031941 events: [=====================48%                           ]Exporting 46031941 events: [=====================49%                           ]Exporting 46031941 events: [======================50%                          ]Exporting 46031941 events: [=======================51%                         ]Exporting 46031941 events: [=======================52%                         ]Exporting 46031941 events: [========================53%                        ]Exporting 46031941 events: [========================54%                        ]Exporting 46031941 events: [=========================55%                       ]Exporting 46031941 events: [=========================56%                       ]Exporting 46031941 events: [==========================57%                      ]Exporting 46031941 events: [==========================58%                      ]Exporting 46031941 events: [===========================59%                     ]Exporting 46031941 events: [===========================60%                     ]Exporting 46031941 events: [============================61%                    ]Exporting 46031941 events: [============================62%                    ]Exporting 46031941 events: [=============================63%                   ]Exporting 46031941 events: [=============================64%                   ]Exporting 46031941 events: [==============================65%                  ]Exporting 46031941 events: [==============================66%                  ]Exporting 46031941 events: [===============================67%                 ]Exporting 46031941 events: [===============================68%                 ]Exporting 46031941 events: [================================69%                ]Exporting 46031941 events: [================================70%                ]Exporting 46031941 events: [=================================71%               ]Exporting 46031941 events: [=================================72%               ]Exporting 46031941 events: [==================================73%              ]Exporting 46031941 events: [==================================74%              ]Exporting 46031941 events: [===================================75%             ]Exporting 46031941 events: [===================================76%             ]Exporting 46031941 events: [====================================77%            ]Exporting 46031941 events: [====================================78%            ]Exporting 46031941 events: [=====================================79%           ]Exporting 46031941 events: [=====================================80%           ]Exporting 46031941 events: [======================================81%          ]Exporting 46031941 events: [======================================82%          ]Exporting 46031941 events: [=======================================83%         ]Exporting 46031941 events: [=======================================84%         ]Exporting 46031941 events: [========================================85%        ]Exporting 46031941 events: [========================================86%        ]Exporting 46031941 events: [=========================================87%       ]Exporting 46031941 events: [=========================================88%       ]Exporting 46031941 events: [==========================================89%      ]Exporting 46031941 events: [==========================================90%      ]Exporting 46031941 events: [===========================================91%     ]Exporting 46031941 events: [===========================================92%     ]Exporting 46031941 events: [============================================93%    ]Exporting 46031941 events: [============================================94%    ]Exporting 46031941 events: [=============================================95%   ]Exporting 46031941 events: [=============================================96%   ]Exporting 46031941 events: [==============================================97%  ]Exporting 46031941 events: [==============================================98%  ]Exporting 46031941 events: [===============================================99% ]Exporting 46031941 events: [===============================================100%]

Exported successfully to
/tmp/nsys-report-9800-231a-1f8f-44a5.sqlite
Report file moved to "/workspace/Chimera/bert_prof/bert-large_chimera_4stages_4gpus_microbs32_acc1_rank0.qdrep"
Report file moved to "/workspace/Chimera/bert_prof/bert-large_chimera_4stages_4gpus_microbs32_acc1_rank0.sqlite"


Sent signal 15 (Terminated) to target application's process group ID = 24706.
Use the kill option to modify this behavior.

The target application terminated with signal 15 (SIGTERM)
Training script completed at Sun Jun  9 22:26:58 +03 2024
scp: /workspace/Chimera/bert_prof/bert-large_chimera_4stages_4gpus_microbs32_acc1_rank2.h5: No such file or directory
scp: /workspace/Chimera/bert_prof/bert-large_chimera_4stages_4gpus_microbs32_acc1_rank2.info.json: No such file or directory
scp: /workspace/Chimera/bert_prof/bert-large_chimera_4stages_4gpus_microbs32_acc1_rank2.json: No such file or directory
scp: /workspace/Chimera/bert_prof/bert-large_chimera_4stages_4gpus_microbs32_acc1_rank2.qdstrm: No such file or directory
scp: /workspace/Chimera/bert_prof/bert-large_chimera_4stages_4gpus_microbs32_acc1_rank2.telem.json: No such file or directory
scp: /workspace/Chimera/bert_prof/bert-large_chimera_4stages_4gpus_microbs32_acc1_rank2.txt: No such file or directory
nsys script completed at Sun Jun  9 22:29:03 +03 2024
