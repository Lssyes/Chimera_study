\n\n\n________________________________________________________________________________________
[Running nsys_wrap.sh rank: 0]
$NSYS_OUTPUT -> /workspace/Chimera/bert_prof/tmp/bert-large_chimera_4stages_4gpus_microbs8_acc1
Warning: LBR backtrace method is not supported on this platform. DWARF backtrace method will be used.
å½“å‰æ—¶é—´: 2024-06-16 20:22:32
tcp://192.168.0.5:1234
0
local_rank 0, local_size 2, rank-0, world_size-4
[[stage_to_ranks]] -> {0: [0, 3], 1: [1, 2], 2: [2, 1], 3: [3, 0]}
[[[[[[[[[[9999]]]]]]]]]]
[[[[[[[[[[9999]]]]]]]]]]
[total_num_samples_per_step: 32]]]]]]]]]]
[max_steps_per_epoch:        312]]]]]]]]]]
total_num_samples: 96 num_epochs: 1
============================
pipeline_method: chimera
num_epochs: 1
num_optimization_steps: 3
world_size: 4
num_replica: 2
num_pipeline: 2
num_micro_batches_per_step: 2
recompute: False
stage0: ranks [0, 3]
stage1: ranks [1, 2]
stage2: ranks [2, 1]
stage3: ranks [3, 0]
----------------------------
corpus_path: ./bert_data/wikipedia.segmented.nltk.txt
corpus_lines: 10000
vocab_path: ./bert_data/bert-large-uncased-vocab.txt
on_memory: False
do_lower_case: True
bert_config_path: ./configs/bert_config_bert-large-uncased.json
max_seq_length: 128
micro_batch_size: 8
num_optimization_steps: 3
num_epochs: None
gradient_accumulation_steps: 1
adam_learning_rate: 3e-05
adam_max_grad_norm: 1.0
beta1: 0.9
weight_decay: 0.01
warmup_proportion: 0.1
damping: 0.01
pipeline_method: chimera
chunks: 2
recompute: False
num_stages: 4
num_pipelines: 2
checkpoint_dir: None
save_checkpoint_steps: 200
seed: 1
p2p_backend: gloo
collective_backend: nccl
num_workers: 4
profile: True
observe_norm: False
log_interval: 1
config: None
wandb: False
============================
Capture range started in the application
Collecting data...
[[pytorch sync]] 0 epoch
[[Chimera start]] 0 epoch
[<pipeline.PipelineStage object at 0x7f1592014a00>, <pipeline.PipelineStage object at 0x7f1592014d00>]
shiiitttt epoch-0 step-0 num_steps_for_this_epoch-3 num_p2p_comm-6
barrier1
barrier2
barrier3
[0;31;40m[epoch-0 step-0 start][0m
[[pass of the dist.barrier()]]
[0;36;40m[[[_call_chimera_pipeline]]][0m
/opt/conda/lib/python3.8/site-packages/transformers/modeling_utils.py:909: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
[0;31;40m[g.device:] cuda:0[0m
[0;31;40m[g.device:] cuda:0[0m
epoch1 step1 loss = 11.019352912902832
[0;31;40m[epoch-0 step-0 start][0m
[[pass of the dist.barrier()]]
[0;36;40m[[[_call_chimera_pipeline]]][0m
[0;31;40m[g.device:] cuda:0[0m
[0;31;40m[g.device:] cuda:0[0m
epoch1 step2 loss = nan
[0;31;40m[epoch-0 step-0 start][0m
[[pass of the dist.barrier()]]
[0;36;40m[[[_call_chimera_pipeline]]][0m
[0;31;40m[g.device:] cuda:0[0m
[0;31;40m[g.device:] cuda:0[0m
epoch1 step3 loss = nan
[0;31;40mMaster Finished!!!![0m
[0;31;40m[Finished!!!!0][0m
Capture range ended in the application
Processing events...
Saving temporary "/tmp/nsys-report-21e6-00c9-14fd-d4e9.qdstrm" file to disk...

Creating final output files...
Processing [0%                                                                 ]Processing [===8%                                                              ]Processing [=======16%                                                         ]Processing [==================================56%                              ]Processing [=============================================================96%   ]Processing [=============================================================97%   ]Processing [==============================================================98%  ]Processing [===============================================================99% ]Processing [===================================58%                             ]Processing [=========================42%                                       ]Processing [===================33%                                             ]Processing [===============27%                                                 ]Processing [============23%                                                    ]Processing [==========20%                                                      ]Processing [========17%                                                        ]Processing [=======15%                                                         ]Processing [======14%                                                          ]Processing [=====13%                                                           ]Processing [=====12%                                                           ]Processing [====11%                                                            ]Processing [===10%                                                             ]Processing [====9%                                                             ]Processing [===8%                                                              ]Processing [==7%                                                               ]Processing [==6%                                                               ]Processing [=5%                                                                ]Processing [4%                                                                 ]Processing [3%                                                                 ]Processing [2%                                                                 ]Processing [1%                                                                 ]Processing [0%                                                                 ]Processing [1%                                                                 ]Processing [2%                                                                 ]Processing [3%                                                                 ]Processing [4%                                                                 ]Processing [=5%                                                                ]Processing [==6%                                                               ]Processing [==7%                                                               ]Processing [===8%                                                              ]Processing [====9%                                                             ]Processing [===10%                                                             ]Processing [====11%                                                            ]Processing [=====12%                                                           ]Processing [=====13%                                                           ]Processing [======14%                                                          ]Processing [=======15%                                                         ]Processing [=======16%                                                         ]Processing [========17%                                                        ]Processing [=========18%                                                       ]Processing [=========19%                                                       ]Processing [==========20%                                                      ]Processing [===========21%                                                     ]Processing [===========22%                                                     ]Processing [============23%                                                    ]Processing [=============24%                                                   ]Processing [=============25%                                                   ]Processing [==============26%                                                  ]Processing [===============27%                                                 ]Processing [===============28%                                                 ]Processing [================29%                                                ]Processing [=================30%                                               ]Processing [=================31%                                               ]Processing [==================32%                                              ]Processing [===================33%                                             ]Processing [===================34%                                             ]Processing [====================35%                                            ]Processing [=====================36%                                           ]Processing [=====================37%                                           ]Processing [======================38%                                          ]Processing [=======================39%                                         ]Processing [=======================40%                                         ]Processing [========================41%                                        ]Processing [=========================42%                                       ]Processing [=========================43%                                       ]Processing [==========================44%                                      ]Processing [===========================45%                                     ]Processing [===========================46%                                     ]Processing [============================47%                                    ]Processing [=============================48%                                   ]Processing [=============================49%                                   ]Processing [==============================50%                                  ]Processing [===============================51%                                 ]Processing [===============================52%                                 ]Processing [================================53%                                ]Processing [=================================54%                               ]Processing [=================================55%                               ]Processing [==================================56%                              ]Processing [===================================57%                             ]Processing [===================================58%                             ]Processing [====================================59%                            ]Processing [=====================================60%                           ]Processing [=====================================61%                           ]Processing [======================================62%                          ]Processing [=======================================63%                         ]Processing [=======================================64%                         ]Processing [========================================65%                        ]Processing [=========================================66%                       ]Processing [=========================================67%                       ]Processing [==========================================68%                      ]Processing [===========================================69%                     ]Processing [===========================================70%                     ]Processing [============================================71%                    ]Processing [=============================================72%                   ]Processing [=============================================73%                   ]Processing [==============================================74%                  ]Processing [===============================================75%                 ]Processing [===============================================76%                 ]Processing [================================================77%                ]Processing [=================================================78%               ]Processing [=================================================79%               ]Processing [==================================================80%              ]Processing [===================================================81%             ]Processing [===================================================82%             ]Processing [====================================================83%            ]Processing [=====================================================84%           ]Processing [=====================================================85%           ]Processing [======================================================86%          ]Processing [=======================================================87%         ]Processing [=======================================================88%         ]Processing [========================================================89%        ]Processing [=========================================================90%       ]Processing [=========================================================91%       ]Processing [==========================================================92%      ]Processing [===========================================================93%     ]Processing [===========================================================94%     ]Processing [============================================================95%    ]Processing [=============================================================96%   ]Processing [=============================================================97%   ]Processing [==============================================================98%  ]Processing [===============================================================99% ]Processing [===============================================================100%]
Saved report file to "/tmp/nsys-report-21e6-00c9-14fd-d4e9.qdrep"
Exporting 9379959 events: [1%                                                  ]Exporting 9379959 events: [2%                                                  ]Exporting 9379959 events: [3%                                                  ]Exporting 9379959 events: [4%                                                  ]Exporting 9379959 events: [5%                                                  ]Exporting 9379959 events: [=6%                                                 ]Exporting 9379959 events: [=7%                                                 ]Exporting 9379959 events: [==8%                                                ]Exporting 9379959 events: [==9%                                                ]Exporting 9379959 events: [==10%                                               ]Exporting 9379959 events: [==11%                                               ]Exporting 9379959 events: [===12%                                              ]Exporting 9379959 events: [===13%                                              ]Exporting 9379959 events: [====14%                                             ]Exporting 9379959 events: [====15%                                             ]Exporting 9379959 events: [=====16%                                            ]Exporting 9379959 events: [=====17%                                            ]Exporting 9379959 events: [======18%                                           ]Exporting 9379959 events: [======19%                                           ]Exporting 9379959 events: [=======20%                                          ]Exporting 9379959 events: [=======21%                                          ]Exporting 9379959 events: [========22%                                         ]Exporting 9379959 events: [========23%                                         ]Exporting 9379959 events: [=========24%                                        ]Exporting 9379959 events: [==========25%                                       ]Exporting 9379959 events: [==========26%                                       ]Exporting 9379959 events: [===========27%                                      ]Exporting 9379959 events: [===========28%                                      ]Exporting 9379959 events: [============29%                                     ]Exporting 9379959 events: [============30%                                     ]Exporting 9379959 events: [=============31%                                    ]Exporting 9379959 events: [=============32%                                    ]Exporting 9379959 events: [==============33%                                   ]Exporting 9379959 events: [==============34%                                   ]Exporting 9379959 events: [===============35%                                  ]Exporting 9379959 events: [===============36%                                  ]Exporting 9379959 events: [================37%                                 ]Exporting 9379959 events: [================38%                                 ]Exporting 9379959 events: [=================39%                                ]Exporting 9379959 events: [=================40%                                ]Exporting 9379959 events: [==================41%                               ]Exporting 9379959 events: [==================42%                               ]Exporting 9379959 events: [===================43%                              ]Exporting 9379959 events: [===================44%                              ]Exporting 9379959 events: [====================45%                             ]Exporting 9379959 events: [====================46%                             ]Exporting 9379959 events: [=====================47%                            ]Exporting 9379959 events: [=====================48%                            ]Exporting 9379959 events: [======================49%                           ]Exporting 9379959 events: [=======================50%                          ]Exporting 9379959 events: [=======================51%                          ]Exporting 9379959 events: [========================52%                         ]Exporting 9379959 events: [========================53%                         ]Exporting 9379959 events: [=========================54%                        ]Exporting 9379959 events: [=========================55%                        ]Exporting 9379959 events: [==========================56%                       ]Exporting 9379959 events: [==========================57%                       ]Exporting 9379959 events: [===========================58%                      ]Exporting 9379959 events: [===========================59%                      ]Exporting 9379959 events: [============================60%                     ]Exporting 9379959 events: [============================61%                     ]Exporting 9379959 events: [=============================62%                    ]Exporting 9379959 events: [=============================63%                    ]Exporting 9379959 events: [==============================64%                   ]Exporting 9379959 events: [==============================65%                   ]Exporting 9379959 events: [===============================66%                  ]Exporting 9379959 events: [===============================67%                  ]Exporting 9379959 events: [================================68%                 ]Exporting 9379959 events: [================================69%                 ]Exporting 9379959 events: [=================================70%                ]Exporting 9379959 events: [=================================71%                ]Exporting 9379959 events: [==================================72%               ]Exporting 9379959 events: [==================================73%               ]Exporting 9379959 events: [===================================74%              ]Exporting 9379959 events: [====================================75%             ]Exporting 9379959 events: [====================================76%             ]Exporting 9379959 events: [=====================================77%            ]Exporting 9379959 events: [=====================================78%            ]Exporting 9379959 events: [======================================79%           ]Exporting 9379959 events: [======================================80%           ]Exporting 9379959 events: [=======================================81%          ]Exporting 9379959 events: [=======================================82%          ]Exporting 9379959 events: [========================================83%         ]Exporting 9379959 events: [========================================84%         ]Exporting 9379959 events: [=========================================85%        ]Exporting 9379959 events: [=========================================86%        ]Exporting 9379959 events: [==========================================87%       ]Exporting 9379959 events: [==========================================88%       ]Exporting 9379959 events: [===========================================89%      ]Exporting 9379959 events: [===========================================90%      ]Exporting 9379959 events: [============================================91%     ]Exporting 9379959 events: [============================================92%     ]Exporting 9379959 events: [=============================================93%    ]Exporting 9379959 events: [=============================================94%    ]Exporting 9379959 events: [==============================================95%   ]Exporting 9379959 events: [==============================================96%   ]Exporting 9379959 events: [===============================================97%  ]Exporting 9379959 events: [===============================================98%  ]Exporting 9379959 events: [================================================99% ]Exporting 9379959 events: [================================================100%]

Exported successfully to
/tmp/nsys-report-21e6-00c9-14fd-d4e9.sqlite
Report file moved to "/workspace/Chimera/bert_prof/tmp/bert-large_chimera_4stages_4gpus_microbs8_acc1/_nccl_rank0.qdrep"
Report file moved to "/workspace/Chimera/bert_prof/tmp/bert-large_chimera_4stages_4gpus_microbs8_acc1/_nccl_rank0.sqlite"


Sent signal 15 (Terminated) to target application's process group ID = 19907.
Use the kill option to modify this behavior.

The target application terminated with signal 15 (SIGTERM)
Training script completed at Sun Jun 16 20:23:53 +03 2024, watching for nsys to complete {30s}...
nsys script completed at Sun Jun 16 20:24:23 +03 2024
